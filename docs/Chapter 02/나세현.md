## 2장 URL과 리소스

URL은 인터넷의 리소스를 가리키는 표준 이름  
전자정보 일부를 가리키며, 그거싱 어디에 있고 어떻게 접근할 수 있는지를 알려줌

### 2.1 인터넷의 리소스 탐색하기

URL은 통합 자원 식별자 혹은 URI라고 불리는 더 일반화된 부류의 부분집합  
URN은 현재 그 리소스가 어디에 존재하든 상관없이 이름만으로 리소스를 식별하지만, URL은 리소스가 어디 있는지 설명해서 리소스를 식별함

`http://www.joes-hardware.com/seasonal/index-fall.html`이라는 URL이 있다고 가정해 보자.

- `http`: URL의 scheme (스킴은 웹 클라이언트가 리소스에 어떻게 접근하는지 알려줌 - 이 경우에는 HTTP 프로토콜 사용)
- `www.joes-hardware.com`: 서버의 위치 (리소스가 어디에 호스팅되어 있는지 알려줌)
- `/seasonal/index-fall.html`: 리소스의 경로

대부분의 URL은 이렇게 `스킴://서버위치/경로` 구조로 이루어져 있음

URL은 `mailto:example@gmail.com` 등 HTTP 프로토콜이 아닌 다른 가용한 프로토콜을 사용할 수도 있음

---

### 2.2 URL 문법

URL 문법은 스킴(HTTP, FTP, SMTP 등)에 따라 달라짐  
하지만 대부분의 URL은 일반 URL 문법을 따르며, 서로 다른 URL 스킴도 형태/문법 면에서 매우 유사함

`<스킴>://<사용자이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>`

위의 모든 컴포넌트를 가지는 URL은 거의 없으며 가장 중요한 컴포넌트들은 **스킴**, **호스트**, **경로**

#### 2.2.1 스킴: 사용할 프로토콜

스킴은 주어진 리소스에 어떻게 접근하는지 알려주는 중요한 정보  
알파벳으로 시작해야 하고 나머지 부분들과 첫번째 `:` 문자로 구분함

#### 2.2.2 호스트와 포트

리소스를 호스팅하고 있는 장비와 그 장비 내에서 리소스에 접근할 수 있는 서버가 어딨는지에 대한 정보 제공  
호스트 컴포넌트는 호스트명/IP 주소 둘 중 하나의 방식으로 제공 가능  
TCP 프로토콜을 사용하는 HTTP는 기본 포트로 80을 사용함

#### 2.2.4 경로

리소스가 서버의 어디에 있는지 알려주며, 각 경로 조각은 자체 파라미터를 가질 수 있음

#### 2.2.5 파라미터

URL의 파라미터 컴포넌트는 애플리케이션이 서버에 정확한 요청을 하기 위해 필요한 입력 파라미터를 받는데 사용함  
`이름/값` 쌍의 리스트로 URL 나머지 부분들로부터 `;` 문자로 구분해 기술

예) `ftp://prep.ai.mit.edu/pub/gnu;type=d`  
이 경우 이름은 `type`, 값은 `d`인 단 한 개의 파라미터를 전달함

#### 2.2.6 질의 문자열

`http://www.joes-hardware.com/inventory-check.cgi?item=1`

물음표의 우측에 있는 값들을 질의 컴포넌트라고 부름  
예시 URL의 질의는 제품번호가 1인 물품의 재고가 있는지 검사  
질의 컴포넌트 포맷에 제약사항은 없으며, 편의상 많은 게이트웨이가 `&`로 나뉜 `이름=값` 쌍 형식의 질의 문자열을 원함

#### 2.2.7 프래그먼트

리소스의 특정 부분을 가리킬 수 있도록, URL은 리소스 내의 조각을 가리킬 수 있는 프래그먼트 컴포넌트를 제공함 (예: HTML 문서에 있는 특정 이미지 등을 가리킬 수 있음)  
프래그먼트는 URL의 오른쪽에 `#` 문자에 이어서 옴

예) `https://www.joes-hardware.com/tools.html#drills`  
이 경우 `tools.html`의 `drills` 파트를 가리킴

일반적으로 HTTP 서버는 전체만을 다루기 때문에, 클라이언트는 서버에 프래그먼트를 전달하지 않음  
브라우저가 전체 리소스를 받은 후, 프래그먼트를 사용해 당신이 보고자 하는 리소스의 일부를 보여주는 형식

---

### 2.3 단축 URL

#### 2.3.1 상대 URL

URL은 **상대 URL**과 **절대 URL**의 두 가지로 나뉨  
절대 URL은 리소스 접근에 필요한 모든 정보를 갖고 있는 반면, 상대 URL은 모든 정보를 담고 있지는 않음  
상대 URL로 모든 정보를 얻기 위해서는 base URL이 필요함

상대 URL 사용 시, 스킴과 호스트 등 다른 컴포넌트들은 컴포넌트가 포함된 리소스의 base URL에서 알아낼 수 있음  
리소스 집합을 쉽게 변경 가능하며, 문서 집합의 위치를 변경하더라도 새로운 base URL에 의해 해석될 것이기에 잘 동작할 것이라는 장점

기저 URL을 찾는 방법들:

- 리소스에서 명시적으로 제공 (`<BASE>` 태그 명시)
- 해당 리소스의 URL을 base URL로 사용

#### 2.3.2 URL 확장

사용자가 URL을 입력한 다음/입력하는 동안에 자동으로 URL을 확장해 전체를 입력하지 않아도 되게 해 줌

- 호스트명 확장: 단순히 yahoo만을 입력하면 `www.`와 `.com`을 붙여주는 방식
- 히스토리 확장: 과거 방문 기록을 저장해 놓고 보여주는 방식

---

### 2.4 안전하지 않은 문자

사용할 수 있는 알파벳과 URL의 인코딩 규칙에 대하여

#### 2.4.2 인코딩 체계

URL에 있는 안전하지 않은 문자들을 표현할 수 있는 인코딩 방식이 고안됨  
안전하지 않은 문자를 `%` 기호로 시작해, ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 이스케이프 문자로 바꿈

#### 2.4.3 문자 제한

URL 내에서 특별한 의미로 예약된 몇몇 문자들이 존재함 (선점된 문자들)  
이러한 예약 문자들을 본래의 목적이 아닌 다른 용도로 쓰려면, 그 전에 반드시 인코딩해야 하는 문자들을 나열해 놓음 (`%`, `/`, `.`, `#`, `?`, `:` 등)

---

### 2.6 미래

URL의 단점: 리소스가 옮겨지면 URL을 더는 사용할 수 없다는 점  
이런 문제를 예방할 방법은 위치와 상관없이 객체를 가리키는 실제 객체의 이름을 사용하는 것 (= URN)  
하지만 URL은 왜 결국 채택되지 않았을까?

- URL ➡️ URN으로 주소 체계를 바꾸는 것은 매우 큰 작업이기 때문
